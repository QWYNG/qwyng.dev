---
title: "Google Cloud Runã§æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã‚‚ã€æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®Sidekiqã‚¸ãƒ§ãƒ–ã‚’ä¸­æ–­ã—ãŸããªã„"
date: 2026-02-08T00:00:00+09:00
draft: false
---

ã„ã‚ã„ã‚äº‹æƒ…ãŒã‚ã‚Šã€Cloud Runã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§å‹•ã„ã¦ã„ã‚‹Sidekiqã®ã€Œå®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã®å®Œäº†ã‚’å¾…ã£ã¦ã‹ã‚‰ã€æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’æ­¢ã‚ãŸã„ã€ã¨ã„ã†æ¬²æœ›ãŒã‚ã‚Šã¾ã—ãŸã€‚  
ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è©¦ã—ã¦ã¿ãŸã®ã§çµæœã‚’æ›¸ãã¾ã™ã€‚

## å•é¡Œ
CloudRunã®æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã£ã¦ Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ãŒSIGTERMã‚’å—ã‘å–ã‚‹ã¨ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¾ã§ã«å®Œäº†ã—ãªã‹ã£ãŸå®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã¯ Redis ã«æˆ»ã•ã‚Œã€ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«å†å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
æ‰‹å‹•ã§Sidekiqã«SIGSTOP -> SIGTERMã‚’è¡Œã£ãŸå¾Œæ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚Œã°ã“ã®æŒ™å‹•ã‚’é¿ã‘ã‚‰ã‚Œã¾ã™ãŒã€ãã‚Œã‚‚ã€Œé•·æœŸé–“ã®ã‚¸ãƒ§ãƒ–ãŒå®Œäº†ã—ãªã„ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã§ããªã„ã€ã¨ã„ã†å•é¡ŒãŒæ®‹ã‚Šã¾ã™ã€‚ 
Sidekiq Enterprise ã«ã¯ã€ã“ã®å•é¡Œã‚’é¿ã‘ã‚‹ãŸã‚ã® [Ent Rolling Restarts](https://github.com/sidekiq/sidekiq/wiki/Ent-Rolling-Restarts) ã¨ã„ã†ä»•çµ„ã¿ãŒã‚ã‚Šã¾ã™ã€‚Ent Rolling Restarts ã§ã¯ã€æ—§ãƒ—ãƒ­ã‚»ã‚¹ã¯æ–°è¦ã‚¸ãƒ§ãƒ–ã®å–å¾—ã‚’æ­¢ã‚ã¤ã¤å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ãŒå®Œäº†ã™ã‚‹ã¾ã§å‹•ãç¶šã‘ã€ãã®é–“ã«æ–°ãƒ—ãƒ­ã‚»ã‚¹ãŒèµ·å‹•ã—ã¦æ–°è¦ã‚¸ãƒ§ãƒ–ã®å‡¦ç†ã‚’å¼•ãç¶™ãã¾ã™ã€‚  
ãŸã ã—ã“ã®æ©Ÿèƒ½ã¯ã€einhorn ã§ Sidekiq ã‚’èµ·å‹•ãƒ»ç®¡ç†ã—ã€åŒä¸€ãƒ›ã‚¹ãƒˆä¸Šã«æ–°ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸå¾Œã«ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç®¡ç†ã™ã‚‹é‹ç”¨ãŒå‰æã§ã™ã€‚ãã®ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’æ–°ã—ã„ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ç½®ãæ›ãˆã‚‹æ–¹å¼ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã§ã¯ã€Ent Rolling Restarts ã‚’ãã®ã¾ã¾é©ç”¨ã—ã¦è§£æ±ºã™ã‚‹ã®ã¯é›£ã—ããªã‚Šã¾ã™ã€‚  

## ã‚¢ã‚¤ãƒ‡ã‚¢
æ‚©ã‚“ã§ã„ãŸã‚‰ [@kawaida](https://x.com/tamamushi_2) ã•ã‚“ã«ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ•™ãˆã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

1. Sidekiq ã‚’å‹•ã‹ã™Cloud Runã‚µãƒ¼ãƒ“ã‚¹ã¯ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã«ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
2. Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã« Cloud Run ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³åï¼ˆK_REVISIONï¼‰ã‚’ tag ã¨ã—ã¦ä»˜ã‘ã‚‹
3. è‡ªåˆ†ã‚ˆã‚Šå¤ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã® Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ¤œæŸ»ã™ã‚‹
4. æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³å´ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒ quietï¼ˆæ–°è¦å–å¾—åœæ­¢ï¼‰ã‹ã¤ busy=0 ã«ãªã£ãŸã‚‰ã€ãã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¿ã‚°ã‚’å¤–ã™
5. ã‚¿ã‚°ãŒå¤–ã‚Œã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ 0 ã®æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¯ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã—ã€çµæœã¨ã—ã¦ Sidekiq ã‚‚åœæ­¢ã™ã‚‹ï¼ˆä½™è¨ˆãªèª²é‡‘ã‚’é¿ã‘ã‚‹ï¼‰


## æ‰‹é †ã®è§£èª¬

### 1. Sidekiq ã‚’å‹•ã‹ã™Cloud Runã‚µãƒ¼ãƒ“ã‚¹ã¯ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã«ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

é€šå¸¸ã€Cloud Run ã§ã¯æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¸ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ 0 ã«ãªã‚Šã€ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒçµ‚äº†ã—ã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹çµ‚äº†æ™‚ã«ã¯ SIGTERM ãŒé€ã‚‰ã‚Œã€çŸ­ã„çŒ¶äºˆ(10ç§’)ã®å¾Œã«å¼·åˆ¶çµ‚äº†ã•ã‚Œã¾ã™ã€‚ãã®çµæœã€å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ãŒä¸­æ–­ã•ã‚Œã‚‹ã¨å†å®Ÿè¡Œã«ãªã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚„ã‚³ã‚¹ãƒˆé¢ã§ã¤ã‚‰ããªã‚Šã¾ã™ã€‚  
ãã“ã§ã€æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§æ„å›³çš„ã«æ­¢ã‚ã‚‹ãŸã‚ã®ç›®å°ã¨ã—ã¦ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã«ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

ã“ã“ã§ä½¿ã†ã®ã¯â€œãƒªãƒ“ã‚¸ãƒ§ãƒ³å˜ä½ã® min-instancesâ€ã§ã€Cloud Run ã® traffic tag ãŒä»˜ã„ã¦ã„ã‚‹é™ã‚Šã€ãã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ 0 ã§ã‚‚ min-instances ãŒåŠ¹ã„ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç¶­æŒã•ã‚Œã¾ã™

```bash
gcloud run deploy practice-worker \
  --tag=gen1 \
  --min-instances=1
```

### 2. Sidekiq ã®ãƒ—ãƒ­ã‚»ã‚¹ã« Cloud Run ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³åã‚’ tag ã¨ã—ã¦ä»˜ã‘ã‚‹

å¾Œã®æ‰‹é †ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ¤åˆ¥ã§ãã‚‹ã‚ˆã†ã«ã€Sidekiq ã®ãƒ—ãƒ­ã‚»ã‚¹ã« Cloud Run ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³åã‚’ tag ã¨ã—ã¦ä»˜ã‘ã¾ã™ã€‚  
å°‘ã—ã‚„ã‚„ã“ã—ã„ã§ã™ãŒã€Sidekiqãƒ—ãƒ­ã‚»ã‚¹ã‚¿ã‚°ã«ã¯CloudRunã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³åã‚’ã¤ã‘ã¦ã„ã¾ã™ã€‚å…ˆç¨‹è¨˜è¿°ã—ãŸCloudRunã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚¿ã‚°`gen1` ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```ruby
config[:tag] = ENV["K_REVISION"]
```

### 3ã€œ4. å¤ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®Sidekiqã‚’æ¤œæŸ»ã—ã€æ¡ä»¶ã‚’æº€ãŸã—ãŸã‚‰ã‚¿ã‚°ã‚’å¤–ã™

ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ã‚’ã€ä¸€å®šé–“éš”ã§å®Ÿè¡Œã™ã‚‹ã‚¸ãƒ§ãƒ–ã¨ã—ã¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã—ã¦ãŠãã¾ã™ã€‚  
ãƒ­ã‚°ã®å‡ºåŠ›ã¨ã‹ã¯çœã„ã¦ã¾ã™ã€‚

```ruby
class OldRevisionCleaner
  def initialize
    @my_revision = ENV.fetch("K_REVISION")
    @cloud_run = CloudRunClient.new
  end

  def run
    # ã‚¿ã‚°ä»˜ããƒªãƒ“ã‚¸ãƒ§ãƒ³ã ã‘ã‚’å–å¾—
    tagged = @cloud_run.tagged_revisions

    # è‡ªåˆ†ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³æƒ…å ±ã ã‘ã‚’å€‹åˆ¥å–å¾—
    my_info = @cloud_run.get_revision(@my_revision)

    process_set = Sidekiq::ProcessSet.new

    tagged.each do |tag_info|
      rev_name = tag_info[:revision]
      next if rev_name == @my_revision

      rev_info = @cloud_run.get_revision(rev_name)

      # è‡ªåˆ†ã‚ˆã‚Šæ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¯è§¦ã‚‰ãªã„ï¼ˆé€£ç¶šãƒ‡ãƒ—ãƒ­ã‚¤å¯¾ç­–ï¼‰
      next if rev_info[:create_time] >= my_info[:create_time]

      # è©²å½“ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã® Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ‹¾ã†ï¼ˆè¤‡æ•°ã‚ã‚‹å¯èƒ½æ€§ã«å‚™ãˆã‚‹ï¼‰
      procs = process_set.select { |p| p["tag"] == rev_name }
      next if procs.empty?

      all_quiet = procs.all? { |p| p["quiet"] }
      total_busy = procs.inject(0) { |acc, p| acc + p["busy"].to_i }

      # quiet ã‹ã¤ busy=0 ã«ãªã£ãŸã‚‰ã€ãã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¿ã‚°ã‚’å¤–ã™
      next unless all_quiet && total_busy.zero?

      @cloud_run.remove_tag!(tag_info[:tag])
    end
  end
end
```

### 5. ã‚¿ã‚°ã‚’å¤–ã—ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯0ã®æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã•ã›ã‚‹

ã‚¿ã‚°ã‚’å¤–ã—ã¦ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯0ã®æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ãŒã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã™ã‚Œã°ã€çµæœã¨ã—ã¦Sidekiqã‚³ãƒ³ãƒ†ãƒŠã‚‚æ¶ˆãˆã¾ã™ã€‚  
ä½™è¨ˆãªèª²é‡‘ã‚’é¿ã‘ã‚‰ã‚Œã¾ã™ã€‚

## å®Ÿè¡Œçµæœã¨ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒã‚¸ãƒˆãƒª

ä»¥ä¸‹ã®æµã‚Œã§ã€Œæ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã‚’å®Œèµ°ã•ã›ãŸå¾Œã«ã€å®‰å…¨ã«æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’è½ã¨ã™ã€ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

1. æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ 180 ç§’ã‚¸ãƒ§ãƒ–ã‚’é–‹å§‹
2. æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã«SIGSTOP ã‚’é€ã‚Šquietã«ã™ã‚‹ã€æ–°è¦ã‚¸ãƒ§ãƒ–ã‚’å–ã‚‰ãªããªã‚‹ï¼ˆå®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã¯ç¶™ç¶šï¼‰
3. ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã‚Šæ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèµ·å‹•ã™ã‚‹
4. æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³å´ã§ CleanupOldRevisionsJob ãŒ 30 ç§’ã”ã¨ã«æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ç›£è¦–ã™ã‚‹
    - quiet=true, busy=1 ã®é–“ã¯ã€Œã¾ã åœæ­¢ã§ãã¾ã›ã‚“ã€
5. æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¸ãƒ§ãƒ–ãŒå®Œäº†ã—ã¦ busy=0 ã«ãªã‚‹
    - æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³å´ãŒ quiet=true && busy=0 ã‚’æ¤œçŸ¥
    - æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¿ã‚°ã‚’å‰Šé™¤ â†’ æ—§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒ SIGTERM ã§è‡ªç„¶åœæ­¢

å®Ÿéš›ã®ãƒ­ã‚°ï¼ˆæŠœç²‹ï¼‰ã¯ä»¥ä¸‹ã§ã™ã€‚

```text
# 1) æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã‚¸ãƒ§ãƒ–é–‹å§‹
INFO  2026-02-07T09:50:53.677Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... class=LongRunningJob: start
INFO  2026-02-07T09:50:53.695Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... ğŸŸ¢ Job started ... duration=180s
INFO  2026-02-07T09:51:03.701Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... â³ Progress: 10/180

# 2) SIGSTOPã‚’é€ã‚Šæ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ quiet åŒ–ï¼ˆæ–°è¦å–å¾—åœæ­¢ï¼‰
INFO  2026-02-07T09:51:07.264Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... Received TSTP, no longer accepting new work
INFO  2026-02-07T09:51:07.264Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... Scheduler exiting...

# 3) æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³èµ·å‹•ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
Starting new instance. Reason: DEPLOYMENT_ROLLOUT ...
=== docker-entrypoint started ===
Starting Sidekiq worker...
INFO  2026-02-07T09:51:39.596Z ... Booted Rails ...
INFO  2026-02-07T09:51:39.838Z ... Scheduling cleanup_old_revisions {"every" => "30s", ...}

# 4) æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®CleanupOldRevisionsJobã§æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç›£è¦–ï¼ˆã¾ã  busy=1 ãªã®ã§æ­¢ã‚ãªã„ï¼‰
INFO  2026-02-07T09:52:03.745Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) â³ Progress: 70/180
INFO  2026-02-07T09:52:09.923Z ... start
INFO  2026-02-07T09:52:12.306Z ... è‡ªåˆ†: practice-worker-00004-g68 (2026-02-07T09:51:20+00:00)
INFO  2026-02-07T09:52:12.376Z ... [OldRevisionCleaner] practice-worker-00003-xsc: quiet=true, busy=1
INFO  2026-02-07T09:52:12.376Z ... [OldRevisionCleaner] practice-worker-00003-xsc: ã¾ã åœæ­¢ã§ãã¾ã›ã‚“ï¼ˆquiet=true, busy=1ï¼‰

# 5) æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚¸ãƒ§ãƒ–å®Œäº† â†’ busy=0 ã‚’æ¤œçŸ¥ã—ã¦ã‚¿ã‚°å‰Šé™¤
INFO  2026-02-07T09:53:53.822Z(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) ... âœ… Job completed ...
INFO  2026-02-07T09:54:09.991Z ... start
INFO  2026-02-07T09:54:10.159Z ... è‡ªåˆ†: practice-worker-00004-g68 (2026-02-07T09:51:20+00:00)
INFO  2026-02-07T09:54:10.207Z ... practice-worker-00003-xsc: quiet=true, busy=0
INFO  2026-02-07T09:54:10.208Z ... ğŸ—‘ï¸ practice-worker-00003-xsc ã®ã‚¿ã‚° 'gen1' ã‚’å‰Šé™¤ã—ã¾ã™
INFO  2026-02-07T09:54:10.785Z ... ã‚¿ã‚° 'gen1' ã‚’å‰Šé™¤ã—ã¾ã—ãŸ

# æ—§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒåœæ­¢ã¸
(æ—§ãƒªãƒ“ã‚¸ãƒ§ãƒ³) Shutting down user disabled instance

# éå»ã®ã‚¿ã‚°ã¤ããƒªãƒ“ã‚¸ãƒ§ãƒ³ãŒãªã‘ã‚Œã°ã‚¹ã‚­ãƒƒãƒ—
INFO  2026-02-07T09:54:40.077Z ... start
INFO  2026-02-07T09:54:40.157Z ... ã‚¿ã‚°ä»˜ããƒªãƒ“ã‚¸ãƒ§ãƒ³ãªã— â†’ ã‚¹ã‚­ãƒƒãƒ—
```

ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒã‚¸ãƒˆãƒª-> https://github.com/QWYNG/dont_kill_busy_sidekiq

ã»ã¨ã‚“ã©LLMã«æ›¸ã‹ã›ãŸã®ã§ã‚³ãƒ¡ãƒ³ãƒˆãŒå¤šã‚ã§ã™ã€‚

## å‚è€ƒ

[Cloud Run ä¸Šã®ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« | Google Cloud å…¬å¼ãƒ–ãƒ­ã‚°](https://cloud.google.com/blog/ja/products/serverless/lifecycle-container-cloud-run)

[Graceful shutdowns on Cloud Run: Deep dive | Google Cloud Blog](https://cloud.google.com/blog/topics/developers-practitioners/graceful-shutdowns-cloud-run-deep-dive?hl=en)

[Set minimum instances for services Â |Â  Cloud Run Â |Â  Google Cloud Documentation](https://docs.cloud.google.com/run/docs/configuring/min-instances)

## ãŠã¾ã‘
### LLMã«ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’è€ƒãˆã¦ã‚‚ã‚‰ã†ã¨æ°—åˆ†ã„ã„
ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ä»•äº‹ã«å–ã‚Šå…¥ã‚ŒãŸã„æ™‚ã€ã€Œã“ã®ç†è«–ã¯å®Œç’§ï¼ PRãƒ‰ãƒ¼ãƒ³ï¼ã€ã§ã¯æµçŸ³ã«ä¸å®‰ã§ã™ã€‚  
ãã“ã§ã€ ã‚„ã‚ŠãŸã„ã“ã¨ã‚’æ›¸ã„ã¦ã€Œã“ã†ã„ã†ã“ã¨ã‚’å€‹äººã§è©¦ã—ãŸã„ã‚“ã ã‘ã©ã€ãƒãƒ³ã‚ºã‚ªãƒ³ä½œã£ã¦ã€ã¨LLMã«ä»»ã›ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰ä»˜ãã§ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’ä½œã£ã¦ãã‚Œã¦ä¾¿åˆ©ã€‚ã€€ã€€

{{< figure src="hands_on.png" alt="ãƒãƒ³ã‚ºã‚ªãƒ³è¨˜äº‹ã®ã‚¹ã‚¯ã‚·ãƒ§" width="80%" >}}
